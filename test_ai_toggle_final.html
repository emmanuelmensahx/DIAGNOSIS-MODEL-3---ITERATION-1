<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Toggle Test - Final</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .success { color: #28a745; }
        .error { color: #dc3545; }
        .info { color: #17a2b8; }
        .ai-toggle {
            margin: 20px 0;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 5px;
        }
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .slider {
            background-color: #2196F3;
        }
        input:checked + .slider:before {
            transform: translateX(26px);
        }
        .test-button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        .test-button:hover {
            background: #0056b3;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ AI Toggle Functionality Test</h1>
        <p>This test verifies that the AI toggle functionality works correctly after fixing the syntax errors.</p>
        
        <div class="ai-toggle">
            <h3>AI Features Toggle</h3>
            <label class="toggle-switch">
                <input type="checkbox" id="aiToggle" checked>
                <span class="slider"></span>
            </label>
            <span id="toggleStatus">AI Features: Enabled</span>
        </div>
        
        <div class="test-section">
            <h3>Test Results</h3>
            <button class="test-button" onclick="testToggleFunctionality()">üîÑ Test Toggle</button>
            <button class="test-button" onclick="testDiagnosisPageLoad()">üìã Test Diagnosis Page Load</button>
            <button class="test-button" onclick="testSyntaxValidation()">‚úÖ Test Syntax Validation</button>
            <div id="testResults"></div>
        </div>
    </div>

    <script>
        // Test the AI toggle functionality
        function testToggleFunctionality() {
            const results = document.getElementById('testResults');
            const toggle = document.getElementById('aiToggle');
            const status = document.getElementById('toggleStatus');
            
            try {
                // Test initial state
                let initialState = toggle.checked;
                results.innerHTML = `<div class="info">üîç Initial AI state: ${initialState ? 'Enabled' : 'Disabled'}</div>`;
                
                // Test toggle functionality
                toggle.checked = !toggle.checked;
                updateToggleStatus();
                
                setTimeout(() => {
                    toggle.checked = !toggle.checked;
                    updateToggleStatus();
                    
                    results.innerHTML += `<div class="success">‚úÖ Toggle functionality test passed!</div>`;
                    results.innerHTML += `<div class="info">üìä Toggle responds correctly to state changes</div>`;
                }, 500);
                
            } catch (error) {
                results.innerHTML += `<div class="error">‚ùå Toggle test failed: ${error.message}</div>`;
            }
        }
        
        function updateToggleStatus() {
            const toggle = document.getElementById('aiToggle');
            const status = document.getElementById('toggleStatus');
            status.textContent = `AI Features: ${toggle.checked ? 'Enabled' : 'Disabled'}`;
        }
        
        function testDiagnosisPageLoad() {
            const results = document.getElementById('testResults');
            
            try {
                // Test if we can access the diagnosis page without syntax errors
                const testFrame = document.createElement('iframe');
                testFrame.style.display = 'none';
                testFrame.src = '/diagnosis_screen.html';
                
                testFrame.onload = function() {
                    results.innerHTML += `<div class="success">‚úÖ Diagnosis page loads without syntax errors!</div>`;
                    document.body.removeChild(testFrame);
                };
                
                testFrame.onerror = function() {
                    results.innerHTML += `<div class="error">‚ùå Diagnosis page failed to load</div>`;
                    document.body.removeChild(testFrame);
                };
                
                document.body.appendChild(testFrame);
                
            } catch (error) {
                results.innerHTML += `<div class="error">‚ùå Page load test failed: ${error.message}</div>`;
            }
        }
        
        function testSyntaxValidation() {
            const results = document.getElementById('testResults');
            
            try {
                // Test basic JavaScript syntax validation
                const testCode = `
                    try {
                        console.log('Testing syntax');
                    } catch (error) {
                        console.error('Error:', error);
                    }
                `;
                
                // If this executes without throwing, syntax is valid
                new Function(testCode)();
                
                results.innerHTML += `<div class="success">‚úÖ JavaScript syntax validation passed!</div>`;
                results.innerHTML += `<div class="info">üìù No syntax errors detected in test code</div>`;
                
            } catch (error) {
                results.innerHTML += `<div class="error">‚ùå Syntax validation failed: ${error.message}</div>`;
            }
        }
        
        // Initialize toggle functionality
        document.addEventListener('DOMContentLoaded', function() {
            const toggle = document.getElementById('aiToggle');
            toggle.addEventListener('change', updateToggleStatus);
            updateToggleStatus();
            
            // Auto-run initial tests
            setTimeout(() => {
                document.getElementById('testResults').innerHTML = '<div class="info">üöÄ Running initial tests...</div>';
                testSyntaxValidation();
                setTimeout(testDiagnosisPageLoad, 1000);
            }, 500);
        });
    </script>
</body>
</html>